import streamlit as st
import os
if st.session_state.get('needs_face_auth') and not st.session_state.get('face_verified'):
    st.warning('üõ°Ô∏è Face ID Verification Required')
    v_img = st.camera_input('Scan face')
    if v_img:
        from face_engine import engine
        u = st.session_state.get('temp_user')
        r = st.session_state.get('temp_role', 'Student')
        if u:
            ref = f'assets/profiles/{r.lower()}_{u["id"]}.jpg'
            ok, msg = engine.verify(v_img, ref)
            if ok:
                st.session_state.update({'user_info': u, 'role': r, 'logged_in': True, 'face_verified': True})
                st.rerun()
            else:
                st.error(f'Mismatch: {msg}')
    st.stop()

from leave_utils import check_on_leave
import sys, os; sys.path.append(os.getcwd()); sys.path.append(os.path.join(os.getcwd(), "apsokara/logic"))
from apsokara.logic.teacher_modules import render_marks_entry
from apsokara.logic.student_modules import render_my_result
from apsokara.logic.class_teacher_modules import render_final_upload
from news_utility import render_news_ticker
import streamlit as st
try:
    import numpy as np
    from PIL import Image
except ImportError:
    pass
import numpy as np
from PIL import Image
import base64
import datetime
import sqlite3
import pandas as pd
import plotly.graph_objects as go
from mobile_portal import render_mobile_view

# 1. Page Config
st.set_page_config(
    page_title="APS OKARA PORTAL", 
    page_icon="data:image/png;base64,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", 
    layout="wide", 
    initial_sidebar_state="expanded"
)

# 2. Global Styles & Logo Injection
st.markdown('''
<style>
    /* Top Gap Fix */
    .block-container { padding-top: 1rem !important; }
    header { visibility: hidden !important; }
    
    /* Sidebar Logo */
    [data-testid="stSidebarNav"]::before {
        content: "";
        display: block;
        margin: 20px auto;
        width: 100px;
        height: 100px;
        background-image: url("data:image/png;base64,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");
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
    }
</style>
''', unsafe_allow_html=True)

# 3. PWA Setup
st.markdown('''
<script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('./static/app_assets/sw.js');
      });
    }
</script>
''', unsafe_allow_html=True)

# 4. App Start
render_news_ticker()

# --- Rest of your original code ---

def enroll_face(user_id, role):
    st.subheader("üì∏ Face Enrollment")
    st.info("Apni clear photo capture karein system mein register hone ke liye.")
    
    if new_img:
        save_path = f"assets/profiles/{role.lower()}_{user_id}.jpg"
        with open(save_path, "wb") as f:
            f.write(new_img.getbuffer())
        
        # Database mein status update karna
        import sqlite3
        conn = sqlite3.connect('db.sqlite3')
        table = 'apsokara_student' if role == 'Student' else 'apsokara_teacher'
        conn.execute(f"UPDATE {table} SET face_status='ENROLLED' WHERE id=?", (user_id,))
        conn.commit()
        conn.close()
        
        st.success("‚úÖ Face Enrolled Successfully! Next time aapko Face ID chahiye hogi.")
        if st.button("Refresh Portal"):
            st.rerun()


def check_on_leave(student_id):
    try:
        import sqlite3
        import datetime
        conn = sqlite3.connect('db.sqlite3')
        today = datetime.date.today().isoformat()
        cur = conn.cursor()
        # Naye table 'apsokara_studentleave' se check karna
        query = "SELECT id FROM apsokara_studentleave WHERE student_id=? AND status='Approved' AND ? BETWEEN from_date AND to_date"
        cur.execute(query, (student_id, today))
        res = cur.fetchone()
        conn.close()
        return True if res else False
    except Exception as e:
        return False

def get_pending_count(u):
    try:
        conn = sqlite3.connect('db.sqlite3')
        cur = conn.cursor()
        cur.execute("SELECT COUNT(*) FROM apsokara_leaverequests WHERE student_class=? AND student_section=? AND wing=? AND status='Pending'", (u.get('class'), u.get('sec'), u.get('wing')))
        count = cur.fetchone()[0]
        conn.close()
        return f" ({count})" if count > 0 else ""
    except: return ""

# --- PROFESSIONAL NOTIFICATION SYSTEM (INJECTED) ---
def display_notifications():
    try:
        conn = sqlite3.connect("db.sqlite3", timeout=30)
        cur = conn.cursor()
        cur.execute("SELECT title, content, date_posted FROM apsokara_schoolnotice WHERE is_active=1 ORDER BY date_posted DESC LIMIT 8")
        notices = cur.fetchall()
        conn.close()
        count = len(notices)
        badge_val = f"{count}" if count <= 9 else "9+"
        notices_html = ""
        for n in notices:
            notices_html += f"""
            <div style="padding:12px; border-bottom:1px solid #f0f0f0; transition: background 0.3s;">
                <div style="font-weight:700; color:#1b4332; font-size:14px; margin-bottom:3px;">{n[0]}</div>
                <div style="color:#444; font-size:13px; line-height:1.4;">{n[1]}</div>
                <div style="color:#999; font-size:10px; margin-top:5px; text-align:right;">{n[2]}</div>
            </div>
            """
        if not notices:
            notices_html = "<div style='padding:30px; text-align:center; color:#999;'>No new notifications</div>"

        st.markdown(f"""
        <style>
            .notif-wrapper {{ position: fixed; bottom: 30px; right: 30px; z-index: 999999; }}
            .notif-bell {{ background: #FF0000; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 20px rgba(0,0,0,0.3); border: 2px solid white; font-size: 28px; position: relative; }}
            .notif-badge {{ position: absolute; top: -5px; right: -5px; background: #1b4332; color: white; border-radius: 50%; width: 26px; height: 26px; font-size: 11px; font-weight: 800; display: flex; align-items: center; justify-content: center; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }}
            .notif-window {{ position: absolute; bottom: 80px; right: 0; width: 330px; max-height: 450px; background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); display: none; flex-direction: column; overflow: hidden; border: 1px solid #ddd; animation: popUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }}
            @keyframes popUp {{ from {{ transform: scale(0.8) translateY(20px); opacity: 0; }} to {{ transform: scale(1) translateY(0); opacity: 1; }} }}
            .notif-wrapper:focus-within .notif-window {{ display: flex; }}
            .notif-header {{ background: #1b4332; color: white; padding: 15px; font-weight: 800; font-size: 16px; border-bottom: 2px solid #FFD700; }}
            .notif-content {{ overflow-y: auto; background: #fff; }}
        </style>
        <div class="notif-wrapper" tabindex="0">
            <div class="notif-window">
                <div class="notif-header">üîî Recent Notifications</div>
                <div class="notif-content">{notices_html}</div>
            </div>
            <div class="notif-bell">
                <span>üîî</span>
                <div class="notif-badge">{badge_val}</div>
            </div>
        </div>
        """, unsafe_allow_html=True)
    except: pass

def display_ticker():
    try:
        conn = sqlite3.connect("db.sqlite3", timeout=30)
        cur = conn.cursor()
        cur.execute("SELECT title, content, scheme FROM apsokara_schoolnotice WHERE is_active=1 ORDER BY date_posted DESC LIMIT 5")
        notices = cur.fetchall()
        conn.close()
        if notices:
            items = "".join([f"<span style='background:{n[2]};padding:2px 8px;border-radius:4px;font-size:11px;margin-right:8px;color:white;font-weight:bold;'>NEWS</span><b style='color:#FFD700;font-size:16px;'> {n[0]}: </b><span style='color:white;font-size:15px;'>{n[1]}</span> &nbsp;&nbsp;&nbsp; ‚ö° &nbsp;&nbsp;&nbsp; " for n in notices])
            st.markdown(f"""
            <style>
                .ticker-wrapper {{ display: flex; background: #1b4332; border-radius: 10px; overflow: hidden; border: 1px solid #333; height: 50px; align-items: center; box-shadow: 0 4px 15px rgba(0,0,0,0.5); position: relative; margin-bottom: 20px; }}
                .live-label {{ background: #ff0000; color: white; padding: 0 25px; height: 100%; display: flex; align-items: center; font-weight: 900; font-size: 14px; z-index: 10; box-shadow: 10px 0 20px rgba(0,0,0,0.5); text-transform: uppercase; }}
                .ticker-scroll-container {{ flex-grow: 1; overflow: hidden; white-space: nowrap; position: relative; display: flex; align-items: center; mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent); }}
                .ticker-text {{ display: inline-block; padding-left: 100%; animation: tv-marquee 40s linear infinite; color: white; }}
                @keyframes tv-marquee {{ 0% {{ transform: translate3d(0, 0, 0); }} 100% {{ transform: translate3d(-100%, 0, 0); }} }}
                .live-label::after {{ content: ""; width: 10px; height: 10px; background: white; border-radius: 50%; margin-left: 10px; animation: pulse-dot 1s infinite; }}
                @keyframes pulse-dot {{ 0% {{ opacity: 1; }} 50% {{ opacity: 0.2; }} 100% {{ opacity: 1; }} }}
            </style>
            <div class="ticker-wrapper">
                <div class="live-label">Live Updates</div>
                <div class="ticker-scroll-container">
                    <div class="ticker-text">{items} {items}</div>
                </div>
            </div>
            """, unsafe_allow_html=True)
    except: pass

display_ticker()
display_notifications()

if 'logged_in' not in st.session_state:
    st.session_state.logged_in = False
    st.session_state.role = None
    st.session_state.user_info = {}

def get_base64(file_path):
    try:
        with open(file_path, "rb") as f: data = f.read()
        return base64.b64encode(data).decode()
    except: return ""

LOGO_PATH = '/home/sami/Downloads/sami.png'
img_base64 = get_base64(LOGO_PATH)

def get_history_df(student_id):
    conn = sqlite3.connect('db.sqlite3')
    q = "SELECT date, status FROM apsokara_attendance WHERE student_id=? AND session_year = (SELECT session_year FROM apsokara_student WHERE id=?) GROUP BY date ORDER BY date DESC"
    df = pd.read_sql_query(q, conn, params=(u['id'], u['id']))
    conn.close()
    if not df.empty:
        df['date'] = pd.to_datetime(df['date'])
        df['Day'] = df['date'].dt.strftime('%A')
        df['Date'] = df['date'].dt.strftime('%d-%m-%Y')
        df.refull_name(columns={'status': 'Status'}, inplace=True)
        return df[['Date', 'Day', 'Status']]
    return pd.DataFrame()

def get_student_overall_stats(student_id):
    conn = sqlite3.connect('db.sqlite3')
    # Count only unique dates for this student
    q = "SELECT status, COUNT(*) as count FROM apsokara_attendance WHERE student_id=? AND session_year = (SELECT session_year FROM apsokara_student WHERE id=?) GROUP BY status"
    df = pd.read_sql_query(q, conn, params=(u['id'], u['id']))
    conn.close()
    stats = {"P": 0, "A": 0, "L": 0, "Total": 0}
    for _, row in df.iterrows():
        stats[row['status']] = row['count']
    stats['Total'] = sum([stats['P'], stats['A'], stats['L']])
    return stats

def check_attendance_state(t_class, t_sec, t_wing):
    conn = sqlite3.connect('db.sqlite3')
    cursor = conn.cursor()
    today = datetime.date.today().isoformat()
    cursor.execute("""SELECT MAX(edit_count) FROM apsokara_attendance 
                      WHERE student_class=? AND student_section=? AND date=? 
                      AND student_id IN (SELECT cnic FROM apsokara_student WHERE wing=?)""", 
                   (t_class, t_sec, today, t_wing))
    res = cursor.fetchone()
    conn.close()
    return res[0] if res[0] is not None else 0

def save_attendance(attendance_data, t_class, t_sec, is_edit=False):
    conn = sqlite3.connect('db.sqlite3')
    cursor = conn.cursor()
    today = datetime.date.today().isoformat()
    new_count = 2 if is_edit else 1
    try:
        for s_id, status in attendance_data.items():
            cursor.execute("DELETE FROM apsokara_attendance WHERE student_id=? AND session_year = (SELECT session_year FROM apsokara_student WHERE id=?) AND date=?", (s_id, today))
            cursor.execute('''INSERT INTO apsokara_attendance 
                            (student_id, date, status, class, student_section, edit_count) 
                            VALUES (?, ?, ?, ?, ?, ?)''', (s_id, today, status, t_class, t_sec, new_count))
        conn.commit()
        return True
    except: return False
    finally: conn.close()




def fetch_user_data(user_id, dob_val, user_type):
    conn = sqlite3.connect('db.sqlite3')
    conn.row_factory = sqlite3.Row
    cursor = conn.cursor()
    try:
        if user_type == "Teacher":
            q = "SELECT *, assigned_wing as wing, assigned_class as class, assigned_section as sec FROM apsokara_teacher WHERE cnic = ? AND dob = ?"
        else:
            q = "SELECT *, student_class as class, student_section as sec FROM apsokara_student WHERE b_form = ? AND dob = ?"
        
        cursor.execute(q, (user_id, dob_val))
        row = cursor.fetchone()
        if row:
            data = dict(row)
            # Module compatibility fix
            if 'id' in data:
                data['id_num'] = data['id']
            # Yahan asali jaadu hai:
            if user_type == "Teacher" and row['is_class_teacher'] == 1:
                data['role_db'] = "Class Teacher"
            else:
                data['role_db'] = user_type
            return data
        return None
    except Exception as e:
        st.error(f"Database Error: {e}")
        return None
    finally:
        conn.close()




def get_daily_analytics(t_class, t_sec, t_wing):
    conn = sqlite3.connect('db.sqlite3')
    today = datetime.date.today().isoformat()
    q_total = "SELECT COUNT(*) FROM apsokara_student WHERE student_class=? AND student_section=? AND wing=?"
    total = pd.read_sql_query(q_total, conn, params=(t_class, t_sec, t_wing)).iloc[0,0]
    q_stats = """SELECT status, COUNT(*) as count FROM apsokara_attendance 
                 WHERE student_class=? AND student_section=? AND date=?
                 AND student_id IN (SELECT cnic FROM apsokara_student WHERE wing=?)
                 GROUP BY status"""
    df_stats = pd.read_sql_query(q_stats, conn, params=(t_class, t_sec, today, t_wing))
    conn.close()
    stats = {"Present": 0, "Absent": 0, "Leave": 0, "Total": 0}
    for _, row in df_stats.iterrows():
        key = "Present" if row['status'] == 'P' else ("Absent" if row['status'] == 'A' else "Leave")
        stats[key] = row['count']
    return stats

# --- CUSTOM CSS ---
role = st.session_state.role
if True: primary, secondary, accent, btn_color = "#1b4332", "#f0fdf4", "#0c0d0e", "#d4af37" # APS Student
elif False: pass # APS Class Teacher
elif False: pass # APS Subject Teacher
else: primary, secondary, accent, btn_color = "#1b4332", "#F4F7F6", "#333333", "#2196F3"

st.markdown(f'''
<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap');
    * {{ font-family: 'Poppins', sans-serif; color: {accent}; }}
    .stApp {{ background-color: {secondary}; }}
    .hero-card {{ background: #F0F0F0; border-radius: 25px; padding: 30px 40px; margin-bottom: 30px; display: flex !important; flex-direction: row !important; align-items: center !important; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 2px solid {primary}; position: relative; }}
    .hero-logo-container {{ flex: 0 0 130px !important; height: 130px !important; background: white; border-radius: 20px; display: flex !important; align-items: center !important; justify-content: center !important; margin-right: 35px !important; box-shadow: 0 5px 15px rgba(0,0,0,0.08); }}
    .hero-logo-container img {{ width: 90px !important; }}
    .welcome-text {{ font-size: 34px !important; font-weight: 800 !important; margin: 0 0 15px 0 !important; color: {primary}; line-height: 1.1; }}
    .details-row {{ display: flex !important; flex-wrap: wrap !important; gap: 12px !important; margin-top: 5px !important; }}
    .detail-item {{ background: white; padding: 8px 16px; border-radius: 12px; border: 1px solid {primary}33; }}
    .detail-item b {{ display: block; font-size: 10px; text-transform: uppercase; margin-bottom: 2px; color: {primary}; opacity: 0.8; }}
    .detail-item span {{ font-size: 14px !important; font-weight: 600 !important; color: {accent}; }}
    .stTabs [data-baseweb="tab-list"] {{ gap: 15px !important; justify-content: center !important; display: flex !important; width: 100% !important; background-color: transparent !important; margin: 20px 0 30px 0 !important; }}
    .stTabs [data-baseweb="tab"] {{ height: 50px; background-color: {secondary}; border-radius: 12px; padding: 10px 25px; font-weight: 600; border: 1px solid {primary}33; transition: all 0.3s; }}
    .stTabs [aria-selected="true"] {{ background-color: {primary} !important; color: white !important; border-bottom: none !important; }}
    .stButton>button {{ background-color: {btn_color} !important; color: {"#000000" if role == "Subject Teacher" else "white"} !important; font-weight: 800 !important; border-radius: 12px !important; border: none !important; padding: 15px 30px !important; text-transform: uppercase !important; width: 100%; }}
    .stat-card {{ background: white; padding: 20px; border-radius: 20px; text-align: center; border: 1px solid #ddd; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }}
    .stat-val {{ font-size: 28px; font-weight: 800; color: {primary}; }}
    .stat-lbl {{ font-size: 12px; font-weight: 600; color: #666; text-transform: uppercase; }}
</style>
''', unsafe_allow_html=True)

def show_dashboard():
    role = st.session_state.role
    u = st.session_state.user_info
    if role == "Student":
        tag, tag_col = "üéì STUDENT PORTAL", "#1b4332"
        extra = f'''<div class="detail-item"><b>üë®‚Äçüë¶ Father</b><span>{u.get("father_name")}</span></div><div class="detail-item"><b>üÜî CNIC</b><span>{u.get("cnic")}</span></div><div class="detail-item"><b>üìÖ DOB</b><span>{u.get("dob")}</span></div><div class="detail-item"><b>‚ò™Ô∏è Religion</b><span>{u.get("religion")}</span></div><div class="detail-item"><b>üìû Contact</b><span>{u.get("contact")}</span></div><div class="detail-item"><b>üè† Address</b><span>{u.get("address")}</span></div><div class="detail-item"><b>üè´ Assigned</b><span>{u.get("class")}-{u.get("sec")} ({u.get("wing")})</span></div>'''
    elif role == "Class Teacher":
        tag, tag_col = "üë®‚Äçüè´ CLASS INCHARGE", "#1b4332"
        extra = f'''<div class="detail-item"><b>üë®‚Äçüë¶ Father</b><span>{u.get("father_name")}</span></div><div class="detail-item"><b>üÜî CNIC</b><span>{u.get("cnic")}</span></div><div class="detail-item"><b>üìÖ DOB</b><span>{u.get("dob")}</span></div><div class="detail-item"><b>‚ò™Ô∏è Religion</b><span>{u.get("religion")}</span></div><div class="detail-item"><b>üìû Contact</b><span>{u.get("contact")}</span></div><div class="detail-item"><b>üè† Address</b><span>{u.get("address")}</span></div><div class="detail-item"><b>üè´ Assigned</b><span>{u.get("class")}-{u.get("sec")} ({u.get("wing")})</span></div>'''
    else:
        tag, tag_col = "üìñ SUBJECT TEACHER", "#1b4332"
        extra = f'''<div class="detail-item"><b>üë®‚Äçüë¶ Father</b><span>{u.get("father_name")}</span></div><div class="detail-item"><b>üÜî CNIC</b><span>{u.get("cnic")}</span></div><div class="detail-item"><b>üìÖ DOB</b><span>{u.get("dob")}</span></div><div class="detail-item"><b>‚ò™Ô∏è Religion</b><span>{u.get("religion")}</span></div><div class="detail-item"><b>üìû Contact</b><span>{u.get("contact")}</span></div><div class="detail-item"><b>üè† Address</b><span>{u.get("address")}</span></div><div class="detail-item"><b>üè´ Assigned</b><span>{u.get("class")}-{u.get("sec")} ({u.get("wing")})</span></div>'''

    st.markdown(f'''
    <div class="hero-card">
        <div style="position: absolute; top: 15px; right: 15px; z-index: 1000;"><a href="/" target="_self" style="text-decoration: none;"><button style="background: {primary}; border: none; color: white; padding: 10px 18px; border-radius: 12px; cursor: pointer; font-size: 13px; font-weight: 700;">üö™ LOGOUT</button></a></div>
        <div class="hero-logo-container"><img src="data:image/png;base64,{img_base64}"></div>
        <div class="hero-info">
            <div style="font-size:11px; font-weight:800; letter-spacing:2px; color:{tag_col}; margin-bottom:5px;">{tag}</div>
            <div class="welcome-text">Welcome Back, {u.get('full_name', u.get('full_name', 'User'))}! ‚ú®</div>
            <div class="details-row">
                <div class="detail-item"><b>üë§ Full Name</b><span>{u.get('full_name', u.get('full_name', 'User'))}</span></div>
                <div class="detail-item"><b>üè¢ Wing</b><span>{u.get('wing')} Wing</span></div>
                {extra}
            </div>
        </div>
    </div>
    ''', unsafe_allow_html=True)

    if role == "Student": tabs_list = ["üè† HOME", "üìÖ DAILY DIARY", "üìú ATTENDANCE HISTORY", "üìù APPLY LEAVE", "üèÜ MY RESULT", "üîí FACE LOCK"]
    elif role == "Class Teacher": tabs_list = ["üè† DASHBOARD", "üìì POST DIARY", "üìù ATTENDANCE SYSTEM", f"üì• LEAVE APPROVALS{get_pending_count(u)}", "üîí FACE LOCK"]
    else: tabs_list = ["üè† DASHBOARD", "üìì POST DIARY", "üìö TEACHING SCHEDULE", "üéØ MARKS ENTRY", "üìù ATTENDANCE", "üîí FACE LOCK"]
    
    active_tabs = st.tabs(tabs_list)
    for i, tab in enumerate(active_tabs):
        with tab:
            t_full_name = tabs_list[i].upper()
            if 'FACE LOCK' in t_full_name:
                st.stop()
                st.stop()  # Is ke baad ka saara kachra tab mein nahi dikhega
            if "MY RESULT" in t_full_name or "RESULT" in t_full_name:
                from apsokara.logic.student_modules import render_my_result
                render_my_result(u)
            elif "ATTENDANCE HISTORY" in t_full_name:
                from attendance_logic import render_student_attendance
                render_student_attendance(u)
            elif "MARKS ENTRY" in t_full_name:
                from apsokara.logic.teacher_modules import render_marks_entry
                render_marks_entry(u)
            elif "FINAL UPLOAD" in t_full_name:
                from apsokara.logic.class_teacher_modules import render_final_upload
                render_final_upload(u)
            elif "ATTENDANCE SYSTEM" in t_full_name or "ATTENDANCE" in t_full_name:
                from attendance_system import render_attendance_system
                render_attendance_system(u)
            elif "LEAVE" in t_full_name:
                from apsokara.logic.student_modules import render_apply_leave
                render_apply_leave(u)
            
            elif "FACE LOCK" in t_full_name:
                u = st.session_state.user_info
                uid = u.get('id')
                role = st.session_state.role
                
                # Check current status from DB
                import sqlite3
                _c = sqlite3.connect('db.sqlite3')
                _table = 'apsokara_student' if role == 'Student' else 'apsokara_teacher'
                _status = _c.execute(f'SELECT face_status FROM {_table} WHERE id=?', (uid,)).fetchone()
                _c.close()
                status = str(_status[0]).upper() if _status else 'NOT SET'

                if status != 'ENROLLED':
                    st.subheader("üõ°Ô∏è Setup 2-Step Face Verification")
                    st.write("Apne account ko secure banayein. Agli baar login ke liye face scan zaroori hoga.")
                    if img:
                        save_path = f"assets/profiles/{role.lower()}_{uid}.jpg"
                        os.makedirs("assets/profiles", exist_ok=True)
                        with open(save_path, "wb") as f_img:
                            f_img.write(img.getbuffer())
                        engine.update_db_status(uid, role, 'ENROLLED')
                        st.success("‚úÖ Face ID Enabled! Next login will require verification.")
                        st.rerun()
                else:
                    st.success("üîí Face ID is currently ACTIVE")
                    with st.expander("‚ôªÔ∏è Reset Face ID"):
                        st.warning("Face ID reset karne ke liye credentials verify karein.")
                        if role == 'Student':
                            v_input = st.text_input("Enter B-Form Number")
                            original = u.get('b_form')
                        else:
                            v_input = st.text_input("Enter CNIC Number")
                            original = u.get('cnic')
                        
                        dob_input = st.date_input("Confirm Date of Birth")
                        # Basic check against session data
                        if st.button("Verify & Reset"):
                            if v_input == str(original):
                                engine.update_db_status(uid, role, 'NOT SET')
                                st.success("Face ID has been reset. You can now re-enroll.")
                                st.rerun()
                            else:
                                st.error("Verification failed! Incorrect credentials.")

        if st.session_state.get('bio_toggle'):
            st.markdown('''<div style='border:4px solid #1b4332; border-radius:50%; width:220px; height:220px; overflow:hidden; margin:10px auto; position:relative;'><div style='position:absolute; top:0; left:0; width:100%; height:5px; background:#00ff00; box-shadow:0 0 20px #00ff00; animation:scanLine 1.5s infinite alternate;'></div><style>@keyframes scanLine { from {top:0%} to {top:100%} }</style>''', unsafe_allow_html=True)
            st.markdown('</div>', unsafe_allow_html=True)
        if st.session_state.get('bio_toggle'):
            st.markdown('''<div style='border:2px solid #d4af37; padding:10px; border-radius:15px; background:#000; position:relative; overflow:hidden;'><div style='position:absolute; top:0; left:0; width:100%; height:3px; background:#00ff00; box-shadow:0 0 15px #00ff00; animation:scan 2s infinite;'></div><style>@keyframes scan { 0% {top:0%} 100% {top:100%} }</style></div>''', unsafe_allow_html=True)
        dob_s = st.date_input("Birth Date", value=datetime.date(2010,1,1), key="s_dob")
        if st.button("ENTER STUDENT PORTAL", key="s_btn"):
            d = fetch_user_data(id_s, str(dob_s), "Student")
            if d:
                st.rerun()
    with t2:
        id_t = st.text_input("CNIC Number", key="t_login")
        dob_t = st.date_input("Birth Date ", value=datetime.date(1990,1,1), key="t_dob")
        if st.button("ENTER STAFF PORTAL", key="t_btn"):
            d = fetch_user_data(id_t, str(dob_t), "Teacher")
            if d:
                st.rerun()


# --- MOBILE & SECURITY GUARD ---
import streamlit_javascript as st_js

width = st_js.st_javascript("window.innerWidth")

if st.session_state.get('logged_in'):

        st.markdown("<h3 style='text-align:center;'>üõ°Ô∏è Face Verification Required</h3>", unsafe_allow_html=True)
            ref = f"assets/profiles/{st.session_state.role.lower()}_{st.session_state.user_info.get('id')}.jpg"
            if ok:
                st.rerun()
            else:
                st.error(msg)
        st.stop()

    # A. Mobile View Check
    if width is not None and width < 700:
        render_mobile_view()
        st.stop()
    
    # B. Face ID Check

    # --- SECURE BIOMETRIC GATE ---

    # --- AI BIOMETRIC LOCK ---

    # --- AI BIOMETRIC GATEWAY ---

# --- FINAL ROUTING ---
if not st.session_state.get('logged_in'):
    show_login()
else:
    show_dashboard()

