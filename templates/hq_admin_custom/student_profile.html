{% extends 'hq_admin_custom/base.html' %}
{% block title %}Student Profile | {{ student.full_name }}{% endblock title %}

{% block content %}
<style>
    .profile-wrapper { padding: 1.5rem; background: #f1f5f9; min-height: 100vh; }
    .official-card { background: white; border: 1px solid #cbd5e1; border-radius: 4px; }
    .dossier-header { background: #1e293b; color: white; padding: 2rem; border-left: 8px solid #f59e0b; margin-bottom: 2rem; }
    .nav-breadcrumb { margin-bottom: 1rem; font-size: 0.85rem; }
    .nav-breadcrumb a { color: #64748b; text-decoration: none; }
    .label-box { color: #64748b; font-weight: 800; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 2px; }
    .value-box { color: #1e293b; font-weight: 700; font-size: 1.1rem; margin-bottom: 1.2rem; }
    .status-active { color: #10b981; font-weight: 900; letter-spacing: 1px; }
</style>

<div class="profile-wrapper">
    <nav class="nav-breadcrumb no-print">
        {% for crumb in breadcrumbs %}
            {% if not forloop.last %}
                <a href="{{ crumb.url }}">{{ crumb.name }}</a> <i class="fas fa-chevron-right mx-2" style="font-size: 0.7rem;"></i>
            {% else %}
                <span class="text-dark fw-bold">{{ crumb.name }}</span>
            {% endif %}
        {% endfor %}
    </nav>

    <div class="dossier-header shadow-sm">
        <div class="row align-items-center">
            <div class="col-md-8">
                <span class="badge bg-warning text-dark mb-2 fw-bold">OFFICIAL STUDENT RECORD</span>
                <h1 class="fw-black mb-0" style="font-size: 2.8rem; letter-spacing: -1px;">{{ student.full_name|upper }}</h1>
                <p class="mb-0 opacity-75 fw-bold">Admission ID: APS-{{ student.id|add:"5000" }}</p>
            </div>
            <div class="col-md-4 text-md-end mt-3 mt-md-0">
                <div class="h2 fw-black mb-0 text-warning">{{ student.current_class }}-{{ student.section }}</div>
                <div class="fw-bold">{{ student.wing|upper }} WING</div>
                <button onclick="window.print()" class="btn btn-outline-light btn-sm mt-3 fw-bold no-print"><i class="fas fa-print me-2"></i>PRINT DOSSIER</button>
            </div>
        </div>
    </div>

    <div class="row g-4">
        <div class="col-lg-4">
            <div class="official-card p-4 shadow-sm mb-4">
                <h5 class="fw-black border-bottom pb-2 mb-4"><i class="fas fa-user-shield me-2"></i>PERSONAL PROFILE</h5>
                
                <div class="label-box">Father's Name</div>
                <div class="value-box">{{ student.father_name|upper }}</div>

                <div class="label-box">B-Form / CNIC</div>
                <div class="value-box">{{ student.b_form }}</div>

                <div class="label-box">Date of Birth</div>
                <div class="value-box">{{ student.date_of_birth }}</div>

                <div class="label-box">Contact Status</div>
                <div class="value-box">{{ student.phone_number|default:"No Contact Registered" }}</div>
                
                <div class="label-box">Current Status</div>
                <div class="value-box status-active">ACTIVE / ENROLLED</div>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="official-card shadow-sm overflow-hidden">
                <div class="bg-light p-3 border-bottom d-flex justify-content-between align-items-center">
                    <h5 class="mb-0 fw-black"><i class="fas fa-history me-2"></i>ATTENDANCE HISTORY</h5>
                </div>
                <div class="table-responsive">
                    <table class="table table-striped mb-0">
                        <thead class="table-dark">
                            <tr>
                                <th class="ps-4">Date</th>
                                <th>Day</th>
                                <th>Status</th>
                                <th class="text-end pe-4">System Log</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for record in attendance_history %}
                            <tr>
                                <td class="ps-4 fw-bold text-dark">{{ record.date }}</td>
                                <td class="text-secondary">{{ record.date|date:"l" }}</td>
                                <td>
                                    {% if record.status|upper == 'PRESENT' %}
                                        <span class="badge bg-success">PRESENT</span>
                                    {% elif record.status|upper == 'ABSENT' %}
                                        <span class="badge bg-danger">ABSENT</span>
                                    {% else %}
                                        <span class="badge bg-warning text-dark">{{ record.status|upper }}</span>
                                    {% endif %}
                                </td>
                                <td class="text-end pe-4 small text-muted">HQ-VERIFIED</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4" class="text-center py-5 text-muted">No attendance history found.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}
